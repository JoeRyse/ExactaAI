<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exacta AI</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        :root {
            --header-height: 70px;
            --track-tabs-height: 50px;
            --race-selector-height: 50px;
            
            /* Clean, professional palette */
            --primary: #0f172a;
            --accent: #2563eb;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --bg-light: #f8fafc;
            --bg-card: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f1f5f9;
            color: var(--text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* Header - Elevated with subtle shadow */
        .header {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 1.25rem 2rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            z-index: 200;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05), 0 1px 2px 0 rgba(0, 0, 0, 0.03);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.3px;
            color: var(--primary);
        }

        .logo-svg {
            width: 40px;
            height: 40px;
            flex-shrink: 0;
        }

        .date {
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
            padding: 0.5rem 0.9rem;
            background: var(--bg-light);
            border-radius: 6px;
            border: 1px solid var(--border);
        }

        /* Track Tabs - Subtle elevation */
        .track-tabs {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 0 2rem;
            position: fixed;
            top: var(--header-height);
            left: 0;
            right: 0;
            height: var(--track-tabs-height);
            z-index: 180;
            display: flex;
            align-items: center;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.03);
        }

        .track-tabs-inner {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 0.25rem;
            width: 100%;
        }

        .track-tab {
            background: transparent;
            border: none;
            padding: 0.65rem 1rem;
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.15s ease;
            position: relative;
        }

        .track-tab:hover {
            color: var(--text);
            background: var(--bg-light);
        }

        .track-tab.active {
            color: var(--primary);
            background: var(--bg-light);
            font-weight: 600;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        .track-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent);
        }

        /* Race Selector */
        .race-selector {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 0.75rem 2rem;
            position: fixed;
            top: calc(var(--header-height) + var(--track-tabs-height));
            left: 0;
            right: 0;
            height: var(--race-selector-height);
            z-index: 170;
            display: flex;
            align-items: center;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.02);
        }

        .race-selector-inner {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
            width: 100%;
        }

        .race-selector-label {
            font-size: 0.8rem;
            color: var(--text-light);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-right: 0.5rem;
        }

        .race-jump-btn {
            background: white;
            border: 1px solid var(--border);
            color: var(--text-light);
            padding: 0.4rem 0.85rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.15s ease;
            min-width: 44px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.02);
        }

        .race-jump-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: #eff6ff;
            box-shadow: 0 2px 4px 0 rgba(37, 99, 235, 0.1);
            transform: translateY(-1px);
        }

        .race-jump-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
            box-shadow: 0 2px 4px 0 rgba(37, 99, 235, 0.2), 0 1px 2px 0 rgba(37, 99, 235, 0.1);
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            padding-top: calc(var(--header-height) + var(--track-tabs-height) + var(--race-selector-height) + 2rem);
        }

        /* Race Grid */
        .races-grid {
            display: grid;
            gap: 1.5rem;
        }

        /* Race Card - Elevated with layered shadows */
        .race-card {
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: all 0.2s ease;
            box-shadow: 
                0 1px 3px 0 rgba(0, 0, 0, 0.05),
                0 1px 2px 0 rgba(0, 0, 0, 0.03);
        }

        .race-card:hover {
            box-shadow: 
                0 10px 15px -3px rgba(0, 0, 0, 0.08),
                0 4px 6px -2px rgba(0, 0, 0, 0.03);
            border-color: #cbd5e1;
            transform: translateY(-2px);
        }

        .race-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            background: var(--bg-light);
        }

        .race-title {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.75rem;
        }

        .race-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            letter-spacing: -0.3px;
        }

        .race-conditions {
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .race-surface {
            display: inline-block;
            padding: 0.35rem 0.85rem;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        .surface-dirt { 
            background: #fef3c7;
            color: #92400e;
        }
        
        .surface-turf { 
            background: #d1fae5;
            color: #065f46;
        }
        
        .surface-tapeta { 
            background: #e5e7eb;
            color: #374151;
        }

        .race-body {
            padding: 1.5rem;
        }

        .pace-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-light);
            border-radius: 6px;
            border-left: 3px solid var(--accent);
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.02);
        }

        .section-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-light);
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .pace-text {
            color: var(--text);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Contenders */
        .contenders {
            margin-bottom: 1.5rem;
        }

        .contender {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 1.25rem;
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            align-items: start;
            border-radius: 6px;
            transition: all 0.15s ease;
        }

        .contender:hover {
            background: var(--bg-light);
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.02);
        }

        .contender:last-child {
            border-bottom: none;
        }

        .horse-number {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 2px 4px 0 rgba(15, 23, 42, 0.2);
        }

        .horse-info {
            min-width: 0;
        }

        .horse-name {
            font-weight: 700;
            font-size: 1.05rem;
            margin-bottom: 0.25rem;
            color: var(--primary);
        }

        .horse-connections {
            color: var(--text-light);
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .horse-analysis {
            color: var(--text);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .horse-rating {
            text-align: right;
            white-space: nowrap;
        }

        .stars {
            font-size: 0.95rem;
            margin-bottom: 0.35rem;
            letter-spacing: 1px;
        }

        .stars .filled {
            color: #f59e0b;
            text-shadow: 0 1px 2px rgba(245, 158, 11, 0.3);
        }

        .stars .empty {
            color: #d1d5db;
        }

        .odds {
            color: var(--text-light);
            font-size: 0.85rem;
            font-weight: 600;
            padding: 0.25rem 0.6rem;
            background: var(--bg-light);
            border-radius: 4px;
            border: 1px solid var(--border);
            display: inline-block;
        }

        /* Betting section */
        .betting-section {
            background: var(--bg-light);
            border-radius: 6px;
            padding: 1rem;
            border: 1px solid var(--border);
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.02);
        }

        .bet-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.65rem 0;
            font-size: 0.9rem;
        }

        .bet-type {
            font-weight: 700;
            color: var(--primary);
            font-size: 0.9rem;
        }

        .bet-selection {
            color: var(--text);
            font-family: 'Inter', ui-monospace, monospace;
            font-weight: 600;
            font-size: 0.9rem;
            padding: 0.25rem 0.6rem;
            background: white;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        /* Loading & Empty States */
        .loading-state, .empty-state, .error-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .error-state {
            color: #dc2626;
        }

        /* Highlight Classes */
        .lock {
            background: #fef3c7;
            padding: 0.15rem 0.5rem;
            border-radius: 3px;
            font-weight: 600;
            color: #92400e;
            box-shadow: 0 1px 2px 0 rgba(146, 64, 14, 0.1);
        }

        .value {
            background: #dbeafe;
            padding: 0.15rem 0.5rem;
            border-radius: 3px;
            font-weight: 600;
            color: #1e40af;
            box-shadow: 0 1px 2px 0 rgba(30, 64, 175, 0.1);
        }

        html {
            scroll-behavior: smooth;
        }

        /* Responsive */
        @media (max-width: 768px) {
            :root {
                --header-height: 56px;
                --track-tabs-height: 52px;
                --race-selector-height: 52px;
            }

            .container {
                padding: 1rem;
                padding-top: calc(var(--header-height) + var(--track-tabs-height) + var(--race-selector-height) + 1rem);
            }
            
            .header {
                padding: 0.75rem 1rem;
            }

            .header-content {
                flex-direction: row;
                align-items: center;
                gap: 0.5rem;
            }

            .brand {
                font-size: 1.05rem;
            }

            .logo-svg {
                width: 32px;
                height: 32px;
            }

            /* Hide date on mobile to save space */
            .date {
                display: none;
            }

            .track-tabs-inner {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
            }

            .track-tabs-inner::-webkit-scrollbar {
                display: none;
            }

            .contender {
                grid-template-columns: auto 1fr;
                gap: 1rem;
            }

            .horse-rating {
                grid-column: 2;
                text-align: left;
                margin-top: 0.5rem;
            }

            .race-number {
                font-size: 1.35rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="brand">
                <svg class="logo-svg" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <!-- Horse head silhouette -->
                    <path d="M30 8L28 6L26 8L24 10C22 12 20 13 18 13C16 13 14 11 13 9L12 7C11 5 10 4 8 5C7 6 7 7 8 9L10 12C11 14 13 15 15 15C17 15 19 14 21 12L23 15C24 17 25 19 26 22L27 26C27 28 26 30 24 31C22 32 20 31 19 29L18 27C17 25 16 23 14 22C12 21 10 21 8 22C6 23 5 25 6 27C7 29 9 30 11 30C13 30 15 29 16 27L17 25C18 23 20 22 22 22C24 22 26 23 27 25L28 27C29 29 31 30 33 29C35 28 36 26 36 24L35 20C34 17 32 14 30 12V8Z" fill="url(#gradient1)"/>
                    
                    <!-- Ears -->
                    <path d="M29 6L31 4L33 6" fill="url(#gradient1)"/>
                    
                    <!-- Circuit lines left side -->
                    <line x1="8" y1="14" x2="2" y2="14" stroke="#4ade80" stroke-width="1.5" stroke-linecap="round"/>
                    <circle cx="2" cy="14" r="1.5" fill="#4ade80"/>
                    
                    <line x1="10" y1="18" x2="3" y2="18" stroke="#22d3ee" stroke-width="1.5" stroke-linecap="round"/>
                    <circle cx="3" cy="18" r="1.5" fill="#22d3ee"/>
                    
                    <line x1="12" y1="22" x2="4" y2="22" stroke="#4ade80" stroke-width="1.5" stroke-linecap="round"/>
                    <circle cx="4" cy="22" r="1.5" fill="#4ade80"/>
                    
                    <line x1="11" y1="26" x2="3" y2="26" stroke="#22d3ee" stroke-width="1.5" stroke-linecap="round"/>
                    <circle cx="3" cy="26" r="1.5" fill="#22d3ee"/>
                    
                    <!-- Inner circuit details -->
                    <circle cx="20" cy="16" r="1.5" fill="#4ade80" opacity="0.8"/>
                    <circle cx="23" cy="19" r="1.5" fill="#22d3ee" opacity="0.8"/>
                    <circle cx="21" cy="23" r="1.5" fill="#4ade80" opacity="0.8"/>
                    
                    <path d="M19 17 L21 19 L23 20" stroke="#22d3ee" stroke-width="1" fill="none" opacity="0.6"/>
                    <path d="M21 23 L23 21 L24 19" stroke="#4ade80" stroke-width="1" fill="none" opacity="0.6"/>
                    
                    <!-- Gradient definitions -->
                    <defs>
                        <linearGradient id="gradient1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#0891b2;stop-opacity:1" />
                            <stop offset="50%" style="stop-color:#0e7490;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#155e75;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                </svg>
                Exacta AI
            </div>
            <div class="date" id="displayDate"></div>
        </div>
    </div>

    <div class="track-tabs">
        <div class="track-tabs-inner" id="trackTabs"></div>
    </div>

    <div class="race-selector" id="raceSelector" style="display: none;">
        <div class="race-selector-inner">
            <span class="race-selector-label">Jump to Race:</span>
            <div id="raceJumpButtons"></div>
        </div>
    </div>

    <div class="container">
        <div class="races-grid" id="racesGrid">
            <div class="loading-state">Loading track data...</div>
        </div>
    </div>

    <script>
        const CONFIG = {
            dataSource: 'https://raw.githubusercontent.com/JoeRyse/ExactaAI/main/tracks/',
            tracks: [
                { key: 'Gulfstream Park', file: 'gulfstream.json' },
                { key: 'Fair Grounds', file: 'fairgrounds.json' },
                { key: 'Tampa Bay', file: 'tampabay.json' },
                { key: 'Santa Anita', file: 'santaanita.json' }
            ]
        };

        let trackData = {};
        let currentTrack = null;
        let currentRace = null;

        async function init() {
            await loadAllTracks();
            if (Object.keys(trackData).length > 0) {
                currentTrack = Object.keys(trackData)[0];
                renderTrackTabs();
                renderRaces();
                setupScrollObserver();
            } else {
                document.getElementById('racesGrid').innerHTML = 
                    '<div class="error-state">No track data available. Please check your configuration.</div>';
            }
        }

        async function loadAllTracks() {
            const loadPromises = CONFIG.tracks.map(async track => {
                try {
                    const response = await fetch(CONFIG.dataSource + track.file);
                    if (response.ok) {
                        const data = await response.json();
                        trackData[track.key] = data;
                        console.log(`✓ Loaded ${track.file}`);
                    } else {
                        console.warn(`✗ Failed to load ${track.file} - Status: ${response.status}`);
                    }
                } catch (error) {
                    console.error(`✗ Error loading ${track.file}:`, error);
                }
            });
            
            await Promise.all(loadPromises);
            console.log('Loaded tracks:', Object.keys(trackData));
        }

        function renderTrac
